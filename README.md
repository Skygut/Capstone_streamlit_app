# üìä Rossmann Sales Forecasting  
### –ú–∞–≥—ñ—Å—Ç–µ—Ä—Å—å–∫–∏–π –ø—Ä–æ—î–∫—Ç –∑ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è  
**–ê–≤—Ç–æ—Ä:** Volodymyr Chub  
**–†—ñ–∫:** 2025  

---

## üß© –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–¶–µ–π –ø—Ä–æ—î–∫—Ç –ø—Ä–∏—Å–≤—è—á–µ–Ω–∏–π –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—é –¥–µ–Ω–Ω–∏—Ö –ø—Ä–æ–¥–∞–∂—ñ–≤ —É —Ä–æ–∑–¥—Ä—ñ–±–Ω—ñ–π –º–µ—Ä–µ–∂—ñ **Rossmann**  
–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—É—á–∞—Å–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π.

–ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏ ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—Ç–æ—á–Ω—É, —Å—Ç–∞–±—ñ–ª—å–Ω—É —Ç–∞ –∑—Ä–æ–∑—É–º—ñ–ª—É —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è**,  
—è–∫—É –º–æ–∂–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ —É —Ä–µ–∞–ª—å–Ω—ñ –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å–∏.

–†–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π ML-–ø–∞–π–ø–ª–∞–π–Ω –æ—Ö–æ–ø–ª—é—î:
- –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (EDA),
- —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—é –æ–∑–Ω–∞–∫,
- –æ—á–∏—â–µ–Ω–Ω—è —Ç–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è,
- –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —Ç—é–Ω—ñ–Ω–≥ –º–æ–¥–µ–ª–µ–π,
- –∞–Ω—Å–∞–º–±–ª—é–≤–∞–Ω–Ω—è,
- SHAP-—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é,
- —Ä–æ–∑—Ä–æ–±–∫—É Streamlit-–¥–∞—à–±–æ—Ä–¥—É.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é



```
streamlit_app/
‚îÇ
‚îú‚îÄ‚îÄ app.py # –≥–æ–ª–æ–≤–Ω–∏–π Streamlit-–¥–æ–¥–∞—Ç–æ–∫
‚îú‚îÄ‚îÄ style.css # —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ ‚îú‚îÄ‚îÄ metrics.csv # –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ ‚îú‚îÄ‚îÄ model_results.csv # —Ñ–∞–∫—Ç–∏—á–Ω—ñ —Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
‚îÇ ‚îú‚îÄ‚îÄ shap_values_summary.png
‚îÇ
‚îú‚îÄ‚îÄ plots/
‚îÇ ‚îú‚îÄ‚îÄ eda_sales_distribution.png
‚îÇ ‚îú‚îÄ‚îÄ eda_promo_effect.png
‚îÇ ‚îú‚îÄ‚îÄ correlation_before.png
‚îÇ ‚îú‚îÄ‚îÄ actual_vs_predicted_catboost.png
‚îÇ ‚îú‚îÄ‚îÄ actual_vs_predicted_xgboost.png
‚îÇ ‚îú‚îÄ‚îÄ actual_vs_predicted_randomforest.png
‚îÇ ‚îú‚îÄ‚îÄ residuals_plot.png
‚îÇ
‚îî‚îÄ‚îÄ pages/
‚îú‚îÄ‚îÄ 1_Overview.py
‚îú‚îÄ‚îÄ 2_EDA.py
‚îú‚îÄ‚îÄ 3_Feature_Engineering.py
‚îú‚îÄ‚îÄ 4_Models_Comparison.py
‚îú‚îÄ‚îÄ 5_Predictions.py
‚îú‚îÄ‚îÄ 6_Residuals.py
‚îú‚îÄ‚îÄ 7_SHAP_Explainability.py
‚îî‚îÄ‚îÄ 8_Conclusions.py
```

---

## üîç –î–∞–Ω—ñ

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–∞—Ç–∞—Å–µ—Ç **Rossmann Store Sales** (Kaggle).  
–ü—ñ—Å–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –æ–±—Ä–æ–±–∫–∏:

- ~1 000 000 —Ä—è–¥–∫—ñ–≤  
- –ø–µ—Ä—ñ–æ–¥: 2013‚Äì2015  
- –º–∞–≥–∞–∑–∏–Ω–Ω—ñ —Ç–∞ –ø—Ä–æ–º–æ-–¥–∞–Ω—ñ  
- —Ç–∞—Ä–≥–µ—Ç: `Sales`

---

## üß± ML-–ø–∞–π–ø–ª–∞–π–Ω

### 1Ô∏è‚É£ **EDA ‚Äî –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö**
- –†–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–æ–¥–∞–∂—ñ–≤  
- –í–ø–ª–∏–≤ –ø—Ä–æ–º–æ-–∞–∫—Ü—ñ–π  
- –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞  

### 2Ô∏è‚É£ **–Ü–Ω–∂–µ–Ω–µ—Ä—ñ—è –æ–∑–Ω–∞–∫**
- –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ñ –æ–∑–Ω–∞–∫–∏  
- –ø—Ä–æ–º–æ-—Ñ–∞–∫—Ç–æ—Ä–∏ (`Promo`, `Promo2`, `PromoInterval`, `Promo2SinceWeek`)  
- –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü—ñ—è (`CompetitionDistance`, `CompetitionOpenSinceYear`)  
- –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ  
- StandardScaler –¥–ª—è X —Ç–∞ y  

### 3Ô∏è‚É£ **–ú–æ–¥–µ–ª—ñ**
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ 7 –º–æ–¥–µ–ª–µ–π:

- CatBoost (Base & Tuned)  
- XGBoost  
- RandomForest (Base & Tuned)  
- ElasticNet (–¥–æ–ø–æ–º—ñ–∂–Ω–∞)  
- Weighted Ensemble  
- Stacked Ensemble  

### 4Ô∏è‚É£ **–¢—é–Ω—ñ–Ω–≥**
- GridSearchCV (RandomForest)  
- Optuna Bayesian Optimization (CatBoost)  

### 5Ô∏è‚É£ **–ê–Ω—Å–∞–º–±–ª—é–≤–∞–Ω–Ω—è**
- Weighted Ensemble  
- Stacked Ensemble (GPU base + CPU meta)  

### 6Ô∏è‚É£ **SHAP Explainability**
- –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –æ–∑–Ω–∞–∫  
- –ø–æ—è—Å–Ω–µ–Ω–Ω—è –≤–ø–ª–∏–≤—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤  
- –æ—Ü—ñ–Ω–∫–∞ —Ä–æ–ª—ñ –ø—Ä–æ–º–æ-–∫–∞–º–ø–∞–Ω—ñ–π —ñ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—ñ  

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è

### üèÜ –ù–∞–π–∫—Ä–∞—â–∞ –º–æ–¥–µ–ª—å: **Stacked Ensemble**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–Ω—è |
|--------|----------|
| MAE    | **0.207** |
| RMSE   | **0.301** |
| WAPE   | **0.0919** |
| MAPE   | **10.29%** |
| R¬≤     | **0.9113** |

### ‚ö° –ù–∞–π–∫—Ä–∞—â–µ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è —à–≤–∏–¥–∫—ñ—Å—Ç—å / —Ç–æ—á–Ω—ñ—Å—Ç—å: **CatBoost (Tuned)**

- —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: **0.02 —Å–µ–∫**
- –º–∞–π–∂–µ —Ç–∞–∫–∞ –∂ —Ç–æ—á–Ω—ñ—Å—Ç—å, —è–∫ Stacked Ensemble  
- –Ω–∞–π–∫—Ä–∞—â–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### üìå –î–æ–¥–∞—Ç–∫–æ–≤—ñ —ñ–Ω—Å–∞–π—Ç–∏:
- Promo2, SchoolHoliday, Weekend ‚Üí –≤–∞–≥–æ–º—ñ —Å–µ–∑–æ–Ω–Ω—ñ –π –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ —Ñ–∞–∫—Ç–æ—Ä–∏  
- CompetitionOpenSinceYear ‚Üí –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∞ –æ–∑–Ω–∞–∫–∞ –∑–≥—ñ–¥–Ω–æ SHAP  
- –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è –æ–∑–Ω–∞–∫ –ø—ñ–¥–Ω—è–ª–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –Ω–∞ ~20%  

---

## üñ•Ô∏è Streamlit Dashboard

–£ –ø—Ä–æ—î–∫—Ç—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ **–ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π –±–∞–≥–∞—Ç–æ—Å—Ç–æ—Ä—ñ–Ω–∫–æ–≤–∏–π Streamlit App**:

- –ª—ñ–≤–∏–π sticky-sidebar –∑ —ñ–∫–æ–Ω–∫–∞–º–∏  
- –æ–∫—Ä–µ–º—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è EDA, FE, –º–æ–¥–µ–ª–µ–π, –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤  
- –≥—Ä–∞—Ñ—ñ–∫–∏ Actual vs Predicted  
- –∞–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤  
- SHAP-—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è  
- –∫–∞—Å—Ç–æ–º–Ω–∏–π –¥–∏–∑–∞–π–Ω (CSS)

---

## ‚ñ∂Ô∏è –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫

### 1Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```
pip install streamlit pandas numpy pillow catboost xgboost scikit-learn optuna shap
```
### 2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ Streamlit-–¥–æ–¥–∞—Ç–æ–∫:
```
streamlit run app.py
```
### 3Ô∏è‚É£ –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ:

http://localhost:8501
